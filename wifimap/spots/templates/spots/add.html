<h1>Add Spot</h1>

{% include "messages.html" %}

<form action="{% url spots_add %}" method="post" id="add-spot-form">
    {{ form.as_p }}
    <p><input type="submit" value="Save" id="submit-spot"></p>
    {% csrf_token %}
</form>

<script type="text/javascript" charset="utf-8">
    SpotForm.bindSubmit();
    
    /* all this code is to start the "add stage", I may want to move it to a method (or object)
       and add a way to reverse it, when leave the page */
    
    Map.followCenter( function(lat, lng) {
        SpotForm.updateLatLng( new google.maps.LatLng(lat, lng) );
    });
    
    // update form fields with initial values
    SpotForm.updateLatLng( Map.map.getCenter() );
    Map.getAddressFromLatLng( 
        Map.map.getCenter(), 
        SpotForm.updateAddress 
    );
    
    Map.addCenterMarkerButton();
    
    Map.addMarkerToAdd({
        position: Map.map.getCenter(),
    });
    
    // TODO: when leaving this page: 
    // - hide the "Map.markerToAdd" from Map
    // - remove the "Center point" 
    // - unbind the SpotForm submit
    
</script>
